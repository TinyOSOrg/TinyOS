# 系统概述

## 启动

### MBR

按照启动约定，x86计算机的BIOS会在启动后将满足要求的硬盘的0号扇区加载到物理地址`0x7c00`处，并跳转过去执行。在TinyOS中，`src/boot/mbr.s`中的代码就是该跳转的目标。0号扇区可用空间仅有510字节，不足以加载并初始化内核，故mbr.s从磁盘的1号扇区开始，连续读取了4个扇区的内容，放置在物理内存的`0x900`处，并跳转到该地址继续执行。

### bootloader

`mbr.s`中的代码跳转的目标是所谓的bootloader，它依次完成以下几项任务：

1. 探测内存容量，存放在物理地址为`TOTAL_MEMORY_SIZE_ADDR`（在`src/boot/boot.s`中定义）的双字中。
2. 打开A20地址线，设置GDT（全局段描述符），进入保护模式。
3. 从磁盘中加载elf格式的内核文件。
4. 启用分页机制。
5. 进入内核代码。

(施工中……)
